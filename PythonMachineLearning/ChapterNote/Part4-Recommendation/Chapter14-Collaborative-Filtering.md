# 协同过滤算法(CF)

协同过滤算法是最基本的推荐算法, CF算法从用户的历史行为数据中挖掘出用户的兴趣, 为用户推荐其感兴趣的项.

## 概述

### 问题描述

推荐系统的核心问题是为用户推荐与其兴趣相似度比较高的商品. 此时, 需要一个函数f(x), f(x)可以计算候选商品与
用户之间的相似度,并向用户推荐相似度较高的商品, 为了能够预测出函数f(x), 可以利用到的历史数据主要有: 用户的历史行为数据、
与该用户相关的其他用户信息、商品之间的相似性、文本的描述等.

假设集合C表示所有用户, 集合S表示所有需要推荐的商品.函数f表示商品s到用户c之间的有效性的效用函数, 例如:
<br><center>f: C × S ---> R </center></br>
 其中, R是一个全体的排序集合. 对于每一个用户c∈C, 希望从商品的集合中选出商品, 即s∈S, 以使得应用函数f的值最大.
 
### 常用的推荐算法
- 协同过滤的推荐(Collaborative Filtering Recommendation)
- 基于内容的推荐(Content-based Recommendation)
- 基于关联规则的推荐(Association Rule-based Recommendation)
- 基于效用的推荐(Utility-based Recommendation)
- 基于知识的推荐(Knowledge-based Recommendation)
- 组合推荐(Hybrid Recommendation)

## 基于协同过滤的推荐

核心思想:通过对用户历史行为数据的挖掘发现用户的偏好, 基于不同的偏好对用户进行群组划分并推荐品味相似的项. 在计算推荐
结果的过程中, 不依赖于项的任何附加信息或者用户的任何附加信息, 只与用户对项的评分有关.

通常有两种方法: 
- 基于用户的(User-based)协同过滤算法
    - 通过相似用户进行推荐, 通过比较用户之间的相似性, 越相似表明两者之间的品味越相近.
- 基于项的(Item-based)协同过滤算法
    - 通过比较项与项之间的相似性, 为用户推荐与其打过分的项相似的项.

## 相似度的度量方法

### 欧式距离
欧式距离能够体现个体数值特征的绝对差异, 所以更多的用于需要从维度的数值大小中体现差异的分析, 如使用用户行为指标分析
用户价值的相似度或差异.


### 皮尔逊相关系数(Pearson Correlation)

欧式距离计算中, 不同特征之间的量级对欧式距离的影响比较大.而皮尔逊相关系数的度量方法对量级不敏感, 具体形式为:
<br><center>![](../MularGif/Part4-Recommendation/Chapter14Gif/Pearson%20Correlation.gif)</center></br>
其中<X, Y>表示向量X和向量Y 的内积, ||X||表示向量X的范数

### 余弦相似度
余弦距离更多的是从方向上区分差异, 而对绝对的数值不敏感, 更多的用于使用用户对内容评分来区分兴趣的相似度和差异, 同时
修正了用户间可能存在的度量标准不统一的问题(因为余弦距离对绝对数值不敏感)

余弦相似度是文本相似度度量中使用较多的一种方法, 对于两个向量X和Y, 其余弦相似度对应形式如下:
<br><center>![](../MularGif/Part4-Recommendation/Chapter14Gif/Cosine%20Similarity.gif)</center></br>

## 用户商品推荐实例

大致步骤(基于用户的的协同过滤算法):
- 载入数据, 未评分的置为0
- 计算用户之间的余弦相似度
- 对单个用户进行推荐
    - 找到该用户未曾评价的商品
    - 对该用户所有未曾评价的商品进行预测评分
        - 找到所有其他对此项商品评分过的用户
        - 求其他每个用户相似度 * 用户评分的和作为推荐用户的该商品评分
        - 排序
        - 推荐

基于项的协同推荐大致步骤同上, 只不过换成的是商品用户模型

## 杂谈
- [各种相似度度量算法](https://www.cnblogs.com/chaosimple/archive/2013/06/28/3160839.html), 
其中调整余弦相似度算法可以看一下.